<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Projects – Walter Applied Spatial Ecology Laboratory</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="style.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Walter Applied Spatial Ecology Laboratory</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./cv/index.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./labmembers.html"> 
<span class="menu-text">Lab Members</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Join the Lab/index.html"> 
<span class="menu-text">Join the Lab</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./projects.html" aria-current="page"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./RegForm/index.html"> 
<span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./manual.html"> 
<span class="menu-text">Manual</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="mailto:wdw12@psu" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
    <a href="https://twitter.com/walterASEL" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/walterASEL" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/w-david-walter-4434a094/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#current-projects" id="toc-current-projects" class="nav-link active" data-scroll-target="#current-projects">Current Projects</a></li>
  <li><a href="#completed-projects" id="toc-completed-projects" class="nav-link" data-scroll-target="#completed-projects">Completed Projects</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Projects</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="current-projects" class="level3">
<h3 class="anchored" data-anchor-id="current-projects">Current Projects</h3>
<p>Study Title: Genetic assignment tests using single nucleotide polymorphisms in white-tailed deer as a management tool for chronic wasting disease; Role: Principal Investigator; Funding: U.S. Department of Agriculture’s Animal, Plant Health Inspection Service, Wildlife Services; Dates: September 2024–August 2025; Description: The absence of information regarding genetic structure and origin of CWD-positive deer in vast regions of the US is likely to reduce the effectiveness of CWD management. Genetic assignment tests to population of origin and subpopulation structuring have been applied in a small area in the Mid-Atlantic, USA using microsatellites but with limited success (Miller and Walter 2020, Walter et al.&nbsp;2024). We will expand this effort by adding samples from Delaware, District of Columbia, Maryland, Ohio, New Jersey, New York, and Pennsylvania, using SNPs instead of microsatellites. In addition, information about alleles influencing CWD susceptibility constitutes a foundation for a genomics-based CWD control.</p>
<p>This study has three primary objectives:</p>
<ol type="1">
<li>Evaluate population structure of white-tailed deer in the region using single nucleotide polymorphisms (SNPs) genotyping for comparison to completed population structure using microsatellites,</li>
<li>Develop method for genetic assignment tests to infer subpopulation of origin of wild white-tailed deer using SNPs, and</li>
<li>Assess the possibility of differential susceptibility to CWD in wild deer based on SNP genotypes, identifying alleles associated with susceptibility in the wild.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/SNPsto2024text.jpg" class="img-fluid figure-img"></p>
<figcaption>With single nucleotide polymorphisms (SNPs), we selected a subset of samples from our previous microsatellite dataset for analysis with commercially available SNPS we provided tissue for from 2019 to 2022 <a href="https://storymaps.arcgis.com/stories/9794d395588b45d7a055e86bf42d602b">White-tailed Deer Genetic Resources</a>.</figcaption>
</figure>
</div>
<p>Study Title: Population models to inform management of black bear statewide in Pennsylvania; Role: Co-Principal Investigator; Funding: Pennsylvania Game Commission; Dates: July 2024–June 2029; Description: A Statistical Population Reconstruction (SPR) model has been built by researchers for Pennsylvania; however, previous research indicated that additional collar data in Wildlife Management Units (WMUs) that historically have not had collared bears would benefit the model for sex-specific estimates and for population estimates at the WMU scale. Sex- and age-specific survival for black bear is not available in most areas of the state. To supplement previous efforts to collect this information and use this information in population estimates statewide using SPR models, survival data for black bear needs to be collected statewide. Capture of black bear will be initiated in summer 2024 and den captures in winters 2025-2029 statewide to provide this important information to SPRs at the WMU scale.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/bearSA.png" class="img-fluid figure-img"></p>
<figcaption>Wildlife Management Units (WMUs) with colors representing regional groups of WMUs that represent Study Areas (SAs) in Pennsylvania, USA. Black bear population dynamic data will be collected at SAs and used to compile SPRs.</figcaption>
</figure>
</div>
<p>Study Title: Targeted surveillance for severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) in wildlife; Role: Principal Investigator; Funding: U.S. Department of Agriculture’s Animal and Plant Health Inspection Service under a provision of the American Rescue Plan Act; Dates: November 2022–present; Description: Severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) is the virus that causes COVID-19 in humans. There has been widespread detection of SARS-CoV-2 in North American deer but how so many deer became infected and factors that might lead to persistence of SARS-CoV-2 in deer are unclear. We are conducting coordinated, targeted surveillance in deer populations across the USA to identify risk factors of SARS-CoV-2 transmission and persistence. Our approach includes repeated testing for SARS-CoV-2 of the same numerous deer populations while tracking deer movements.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/collaboratorMapnew.png" class="img-fluid figure-img"></p>
<figcaption>Locations for the team of university, state, and federal researchers using robust data collection and advanced analytics to build a research lens into national wildlife disease surveillance systems</figcaption>
</figure>
</div>
</section>
<section id="completed-projects" class="level3">
<h3 class="anchored" data-anchor-id="completed-projects">Completed Projects</h3>
<p>Study Title: Linking Genetics to Movements of White-tailed deer to Assist Surveillance for Chronic Wasting Disease; Role: Principal Investigator; Funding: U.S. Geological Survey; Dates: July 2020–August 2024; Description: We genotyped the prion gene of individuals sampled from distinct populations of wild white-tailed deer that have experienced CWD for 10–20 years (Maryland/Pennsylvania/Virginia), an area with no current infection (New York; added in 2020), and an area with a recent infection (Ohio; added in 2022) to determine the level of CWD susceptible deer in various subpopulations throughout the region to help managers understand the potential genetic risk factors for CWD in these populations.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/msatsFigure5.png" class="img-fluid figure-img"></p>
<figcaption>Results of the Spatial Bayesian clustering algorithm for the top-ranked run using 1,557 samples (i.e.&nbsp;five white-tailed deer (<em>Odocoileus virginianus</em>) per sex per county), identifying: (a) maximum number of populations simulated from the posterior distribution (K=13), (b) geographic distribution of the 13 inferred clusters with black circles representing sample locations, and (c) Principal Coordinate Analysis (PCoA) showing 13 inferred clusters in ordination space with colors matching those colors used in (b)</figcaption>
</figure>
</div>
<p>Study Title: Assessment of movement of prions across the captive-wild interface; Role: Principal Investigator; Funding: USDA-APHIS-Wildlife Service, National Wildlife Research Center; Dates: August 2021–present; Description: Our primary objective is to determine potential exchange of infectious prion protein material between captive cervid facilities and surrounding areas using Real-Time Quaking-Induced Conversion (RT-QuIC) assays.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/CrowDiagram.png" class="img-fluid figure-img"></p>
<figcaption>The potential flow of infectious prions via crows or other avian scavengers may be multi-directional between captive facilities, communal roost sites, and the surrounding landscape within and outside of the established DMA boundaries</figcaption>
</figure>
</div>
<p>Study Title: Modeling potential habitat for pheasant population restoration; Role: Co-Principal Investigator; Funding: Pennsylvania Game Commission; Dates: July 2015–December 2017; Description: Research on Wild Pheasant Restoration Areas (WPRAs) was being conducted that provided an opportunity to evaluate models under which habitat conditions for wild pheasant populations have met established pheasant density goals based on habitat and landscape composition at the WPRAs.</p>
<p>Study Title: Muskrat ecology and disease; Role: Principal Investigator; Funding: Pennsylvania Game Commission; Dates: February 2016–June 2019; Description: This study was designed to investigate the survival, movements, and potential threats to muskrat.</p>
<p>Study Title: Landscape genetics of white-tailed deer to assess population structure for surveillance of chronic wasting disease; Role: Principal Investigator; Funding: Pennsylvania Game Commission; Dates: February 2016–June 2019; Description: We documented that widespread gene flow (FST &lt; 1.0) and an isolation-by-distance pattern of population structure for deer that was previously undocumented in the region indicating that migration from the core area in adjacent states was likely responsible for chronic wasting disease spread to adjacent states.</p>
<p>Study Title: The effects of targeted removal of deer groups on the epidemiology of chronic wasting disease in wild white-tailed deer in Pennsylvania; Role: Principal Investigator; Funding: Pennsylvania Game Commission; Dates: July 2017–June 2021; Description: Potential elimination of chronic wasting disease in free-ranging deer has occurred (e.g., New York) so it might be possible to focus targeted removal efforts on locations where CWD positive animals are found at or beyond the fringe of an infected area to assess the most suitable method to decrease prevalence and minimize/eliminate transmission out of the disease management area.</p>
<p>Study Title: Modeling the risk of West Nile Virus to Ruffed Grouse Populations in Pennsylvania; Role: Principal Investigator; Funding: Pennsylvania Game Commission; Dates: July 2018–June 2022; Description: Our objectives are to identify the mosquito species that coexist with ruffed grouse in early successional habitat, which mosquito species are important vectors of WNV for ruffed grouse, and which environmental factors increase the risk of WNV exposure to ruffed grouse.</p>
<p>Study Title: Genetic Assignment of White-Tailed Deer to Population of Origin; Role: Principal Investigator; Funding: Pennsylvania Game Commission; Dates: September 2019–June 2023; Description: Landscape genetics can provide the necessary framework to understand landscape features, dispersal characteristics of deer, and transmission and spread of CWD through assessment of population structure using genotypes of deer susceptible to disease, genetic assignment of captive and wild deer, and 11 subpopulations within the Disease Management Areas 1–3 in Pennsylvania and in Maryland/Virginia.</p>
<p>Study Title: Optimizing CWD surveillance: regional synthesis of demographic, spatial, and transmission-risk factors; Funding: Michigan Department of Natural Resources CWD RFP; Dates: July 2019–June 2021; Principal Investigators: Krysten Schuler (Cornell University), Sonja Christensen (Michigan State University), W. David Walter (USGS PA Coop Unit), Daniel Walsh (USGS National Wildlife Health Center), Chris Jennelle (Minnesota Department of Natural Resources), Brenda Hanley (Cornell University); Role: Co-Principal Investigator providing surveillance data from mid-Atlantic region to combine with surveillance data from mid-west to optimize surveillance of chronic wasting disease (Subaward through Cornell University).</p>
<p>Study Title: Optimizing CWD Surveillance: Regional Synthesis of Demographic, Spatial, and Transmission-Risk Factors; Role: Co-Principal Investigator; Funding: Cornell University; Dates: September 2019–August 2022; Description: Several modeling efforts have examined risk factors for chronic wasting disease (CWD), however, we have planned a rigorous integration of various models to derive a more powerful CWD sampling strategy.</p>
<p>Study Title: Parturition timing and calf survival in Pennsylvania elk; Role: Principal Investigator; Funding: Pennsylvania Game Commission; Dates: July 2020–June 2023; Description: The increase in pregnancy rates between autumn and late winter indicates asynchronous breeding in Pennsylvania elk so defining the calving season through use of vaginal implant transmitter technology and calf survival using GPS collars will identify factors that affect recruitment.</p>
<p>Study Title: Minnesota white-tailed deer genetics within chronic wasting disease areas; Role: Principal Investigator; Funding: Minnesota Department of Natural Resources, United States Department of Agriculture; Dates: July 2020–June 2021; Description: The objectives of this project are to conduct genetic analysis testing on wild white-tailed deer to identify shared ancestry (11 msats and mtDNA haplotypes) and susceptibility to chronic wasting disease (PRNP genotypes at codons 95, 96, 116) for deer in various regions throughout the state of Minnesota.</p>
<p>Study Title: Regional assessment of cause-specific mortality in white-tailed deer populations, and influence of landscape attributes and deer density on CWD spread through juvenile deer dispersal and seasonal movements (2018) Funding: NA. Dates: July 2019–June 2021; Principal Investigators: Andrew Norton, Chris Jennelle (MN Department of Natural Resources) and Daniel Walsh (USGS National Wildlife Health Center). Role: Collaborator providing GPS locations from white-tailed deer in the Mid-Atlantic Region and Lead Role in identifying definition of dispersal and risk of infection across the landscape.</p>
<p>Study Title: Establishing a national tissue and reagents repository for chronic wasting disease; Role: Principal Investigator; Funding: U.S. Geological Survey; Dates: September 2021–September 2023; Description: The overall goal of this project is to establish a repository of CWD field isolates from a wide-ranging geographic location in North America that will allow, for the first time, the means to begin to assess the distribution and frequency of chronic wasting disease strains in North America A14 Agent-based models to inform management of white-tailed deer for chronic wasting disease; Role: Principal Investigator; Funding: Pennsylvania Game Commission; Dates: July 2022–June 2025; Description: Objectives of this study are to compile a review of the deer behavior literature on contacts, associations, and observational data for white-tailed deer to compile sex/age-specific likelihood of contacts to inform transmission coefficients for agent-based models.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024, W. David Walter</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>